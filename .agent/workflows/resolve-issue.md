---
description: Issue番号を指定して、ブランチ作成から実装、検証、マージまでの一連のフローを実行します。
---

# 作業概要
* ユーザ/AIが詳細に記載したgithub issueの解決を行うことが目的である。
* あなたの作業の流れは、①要件定義・設計、②実装計画、タスク分割、③実装、テスト（View確認含む）、④ユーザ確認、⑤確認後のマージになる。
* ①、②についてはClaude Opus、Gemini3 Proを想定しており、③、④、⑤についてはGemini Flashを利用する、

## ①要件定義、設計
1. ユーザーからIssue番号（例："102"）が提供されているか確認する。提供されていない場合はユーザーに尋ねる。
2. `gh issue view <NUMBER>` を使用してIssueの詳細を確認する。
3. 作業を開始する際、Issueに `in-progress` ラベルを追加する: `gh issue edit <NUMBER> --add-label "in-progress"`。
4. `feature/issue-<NUMBER>-<SHORT_TITLE>` という名前の新しいブランチを作成する。ショートタイトル（ケバブケース）の生成にはIssueのタイトルを使用する。

## ②実装計画、タスク分割

1. 計画フェーズ (Planning Phase)
- **設計ドキュメントの更新 (事前)**: コードを書く*前に*、意図した変更を反映させるために `docs/02_design/` 内の関連する設計ドキュメントを更新する。
- 変更内容を概説する `implementation_plan.md`・`task.md`を作成または更新する。
-- 上記の作成時に、デバッグ時のTARGET_DATEを指定する場合は必ず2日前を指定するようにすること。原則指定しないこと。
-- 絶対に、当日または未来の日付を指定してはならない。なぜならば当日日付ではレポートが取得できないためである。
- `notify_user` を使用して、計画と設計ドキュメント、タスクのレビューを依頼する。

## ③実装、テスト
- **実装フェーズ**
- 承認されたら、計画に従って変更を実装する。
- debug-modeのTARGET_DATEは実行日の2日前を指定する。
- 進行に合わせて `task.md` を更新する。
- **検証フェーズ (Verification Phase)**:
- `debug-run.md`の内容に則り作業を行う。
- デバッグモードでアプリケーションを実行し、変更を検証する: `DEBUG_MODE=True USE_MOCK_DATA=False python main.py`
- ログと生成されたレポートを確認する。
- `/debug-run` ワークフローまたは手動コマンドを使用してFirebase Hostingにデプロイする。
-- デプロイされていることをcurlで確認する。
- 結果を報告するために `walkthrough.md` を作成する。
- レビューを依頼するために `notify_user` を使用する
-- デプロイしたURLもセットで連携すること。
   > [!CAUTION]
   > **モックモード（`USE_MOCK_DATA=True`）で検証する場合は、必ず事前にユーザーに「この変更はモックで検証可能か」を確認すること。**
   > LLMプロンプト変更やAPI連携の変更はモックでは検証できない。
- **ドキュメントフェーズ (レビュー)**:
- 実装/デバッグ中に行われた変更を取り込むため、`docs/02_design/` 内の関連する設計ドキュメントを更新する。
- 必要に応じて `GEMINI.md` を更新する。
- "Code follows Design"（コードは設計に従う）の原則が守られていることを確認する。

## ④ユーサ確認
- **完了フェーズ (Completion Phase)**:
- **マージ前の確認 (Critical)**: `git diff main...HEAD` を実行し、意図しない変更（特に既存機能の削除や不要なファイルの上書き）が含まれていないか必ず確認する。
- 承認されたら、ブランチを `main` にマージする。
- リモートにプッシュする: `git push origin main`。
- 変更内容と検証結果を要約したコメントを添えてIssueをクローズする。
- 機能ブランチを削除する。

### コミットメッセージのテンプレート
```
feat(#123): 実装内容の要約

- 詳細変更点
- ...

Closes #123
```

Example usage: `/resolve-issue 102`
